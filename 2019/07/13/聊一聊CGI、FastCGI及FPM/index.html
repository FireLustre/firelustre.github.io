<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 聊一聊CGI、FastCGI及FPM · Lustre个人博客</title><meta name="description" content="聊一聊CGI、FastCGI及FPM - firelustre"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Lustre个人博客"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/FireLustre" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">聊一聊CGI、FastCGI及FPM</h1><div class="post-info">Jul 13, 2019</div><div class="post-content"><h2 id="CGI是什么"><a href="#CGI是什么" class="headerlink" title="CGI是什么"></a>CGI是什么</h2><p>CGI全称通用网关接口。通用网关接口（Common Gateway Interface）是一种重要的互联网技术，可以让一个客户端，从网页浏览器向服务器上的程序请求数据。CGI描述了服务器和请求处理程序之间传输数据的一种<code>标准</code>。— 维基百科</p>
<p>说的简单点，所谓CGI其实就是定义了服务器（如nginx）和处理程序（如PHP）之间该如何进行数据交互的标准。如果没有这个标准，服务器按照自己的方式把数据传给处理程序，那处理程序该如何识别，所以提供了一种各类服务器和各个处理程序都认同的的协议，规定了哪些数据该传递，以什么样的方式传递。</p>
<p>那所谓的<code>数据</code>，又是什么？</p>
<p>这里的数据我认为应该分成两部分。第一部分是<strong>入</strong>：服务器传递给处理程序，这个时候会传递如<code>url</code>、<code>request body</code>、<code>request header</code>等信息，PHP解析器(php-cgi)拿到这些信息，进行程序内部的处理。第二部分是<strong>出</strong>：处理程序把响应数据回传给服务器，这个时候的数据就会是<code>response</code>等响应信息、服务器拿到数据后，通过cgi解析，处理完成后，返回给客户端。</p>
<p>CGI就那么完美吗？</p>
<p>答案当然是否定的，每一次的web请求，实现了CGI的进程都会fork一个进程进行处理，当请求处理完之后，就要关闭，这样频繁的对进程进行创建销毁，效率低、处理速度慢，而且当连接数一多，过多的进程就会消耗更多的资源和内存。</p>
<h2 id="FastCGI是什么"><a href="#FastCGI是什么" class="headerlink" title="FastCGI是什么"></a>FastCGI是什么</h2><p>FastCGI从根本上来说其实类似于cgi，也是与语言无关的一种协议。是为了解决cgi的频繁创建销毁造成的资源浪费、才孕育而生了FastCGI。</p>
<h2 id="FPM又是什么"><a href="#FPM又是什么" class="headerlink" title="FPM又是什么"></a>FPM又是什么</h2><p>FPM或者说是PHP-FPM，官方对FPM的解释是Fastcgi Process Manager（Fastcgi 进程管理器）。在说FPM之前就不得不先说一下，PHP官方推出的php-cgi.</p>
<p>php-cgi虽然是官方出品，但是当修改php.ini文件后，需要重启php-cgi，而且php-cgi不支持平滑重启。</p>
<p>PHP-FPM是非官方出品的，是从php5.3之后加入的，它是对FastCGI协议的具体实现，负责一个进程池来管理web服务器的请求。</p>
<h3 id="CGI、FastCGI、PHP-CGI和PHP-FPM关系图"><a href="#CGI、FastCGI、PHP-CGI和PHP-FPM关系图" class="headerlink" title="CGI、FastCGI、PHP-CGI和PHP-FPM关系图"></a>CGI、FastCGI、PHP-CGI和PHP-FPM关系图</h3><p><img src="/images/3E2DA9B4-80D5-454D-929B-B7D571DCBEBD.jpeg" alt="CGI、FastCGI、PHP-CGI和PHP-FPM关系图"></p>
</div></article></div></main><footer><div class="paginator"><a href="/2019/06/23/扬帆 起航/" class="next">NEXT</a></div><div class="copyright"><p>© 2019 <a href="http://yoursite.com">firelustre</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>